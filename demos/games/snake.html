<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Snake — Hector O'Franco</title>
  <link rel="icon" href="../img/logo.png" type="image/png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --bg: #0f172a;
      --card: rgba(30, 41, 59, 0.85);
      --border: rgba(148,163,184,0.12);
      --green-1: #0e4429;
      --green-2: #006d32;
      --green-3: #26a641;
      --green-4: #39d353;
      --text: #f1f5f9;
      --muted: #64748b;
    }

    body {
      background: var(--bg);
      color: var(--text);
      font-family: 'Inter', sans-serif;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    #bg-canvas {
      position: fixed; inset: 0;
      z-index: 0; opacity: 0.3; pointer-events: none;
    }

    .page {
      position: relative; z-index: 1;
      display: flex; flex-direction: column;
      align-items: center;
      padding: 20px 16px 40px;
      min-height: 100vh;
    }

    .header {
      width: 100%; max-width: 640px;
      display: flex; align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
    }

    .back-link {
      display: inline-flex; align-items: center; gap: 6px;
      color: var(--muted); font-size: 0.8rem;
      text-decoration: none; transition: color .2s;
    }
    .back-link:hover { color: var(--green-4); }

    h1 {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.5rem; letter-spacing: .12em; color: var(--green-3);
    }

    .ai-badge {
      font-size: 0.65rem; padding: 3px 10px;
      background: rgba(57,211,83,.1);
      border: 1px solid rgba(57,211,83,.25);
      border-radius: 999px; color: var(--green-3);
    }

    canvas#canvas {
      display: block;
      border: 2px solid rgba(57,211,83,0.2);
      border-radius: 12px;
      background: #000;
      box-shadow: 0 0 40px rgba(57,211,83,0.07);
    }

    .controls {
      display: flex; flex-wrap: wrap;
      gap: 10px; margin-top: 16px;
      align-items: center; justify-content: center;
    }

    .btn {
      background: rgba(57,211,83,.1); color: var(--text);
      border: 1px solid rgba(57,211,83,.25);
      padding: 8px 20px; font-family: 'JetBrains Mono', monospace;
      font-size: 0.8rem; cursor: pointer; border-radius: 8px; transition: all .2s;
    }
    .btn:hover { background: rgba(57,211,83,.25); border-color: var(--green-3); }

    .ctrl-group {
      display: flex; align-items: center;
      gap: 8px; font-size: 0.78rem; color: var(--muted);
    }

    input[type="range"] { width: 80px; accent-color: var(--green-3); }

    #stats {
      margin-top: 10px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.72rem; color: var(--muted); letter-spacing: .04em;
    }

    /* D-pad for mobile */
    .dpad {
      display: none;
      grid-template-columns: 60px 60px 60px;
      grid-template-rows: 60px 60px 60px;
      gap: 5px; margin-top: 18px;
    }
    @media (max-width: 640px) { .dpad { display: grid; } }

    .dpad .btn { width: 60px; height: 60px; font-size: 1.3rem; padding: 0; display: flex; align-items: center; justify-content: center; }
    .dpad .up    { grid-column: 2; grid-row: 1; }
    .dpad .left  { grid-column: 1; grid-row: 2; }
    .dpad .center{ grid-column: 2; grid-row: 2; }
    .dpad .right { grid-column: 3; grid-row: 2; }
    .dpad .down  { grid-column: 2; grid-row: 3; }

    /* Overlay */
    #overlay {
      position: fixed; inset: 0;
      display: none; justify-content: center; align-items: center;
      background: rgba(0,0,0,.75); z-index: 20;
      backdrop-filter: blur(6px);
    }
    #overlay.show { display: flex; }

    .ov-box {
      background: rgba(15,23,42,.95);
      border: 1px solid rgba(57,211,83,.2);
      border-radius: 16px;
      padding: 40px 50px; text-align: center;
    }
    .ov-box h2 { color: var(--green-4); margin-bottom: 10px; font-size: 1.4rem; letter-spacing: .08em; font-family: 'JetBrains Mono', monospace; }
    .ov-box p  { color: var(--muted); margin-bottom: 20px; font-size: 0.9rem; }
  </style>
</head>
<body>
<canvas id="bg-canvas"></canvas>
<div class="page">
  <div class="header">
    <a class="back-link" href="../index.html">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="15 18 9 12 15 6"/></svg>
      Back
    </a>
    <h1>SNAKE</h1>
    <span class="ai-badge">Created via AI generator</span>
  </div>

  <canvas id="canvas"></canvas>

  <div class="controls">
    <button class="btn" id="startBtn">▶ Start</button>
    <div class="ctrl-group">
      <label for="speedRange">Speed</label>
      <input type="range" id="speedRange" min="4" max="20" value="10">
      <span id="speedLabel">10</span>
    </div>
    <div class="ctrl-group">
      <label for="sizeRange">Grid</label>
      <input type="range" id="sizeRange" min="15" max="35" value="20">
      <span id="sizeLabel">20</span>
    </div>
  </div>

  <div id="stats">score: 0 | best: 0</div>

  <div class="dpad">
    <button class="btn up"    onclick="setDir(0,-1)">▲</button>
    <button class="btn left"  onclick="setDir(-1,0)">◀</button>
    <button class="btn center btn-sm" id="pauseBtn" onclick="start()">⏸</button>
    <button class="btn right" onclick="setDir(1,0)">▶</button>
    <button class="btn down"  onclick="setDir(0,1)">▼</button>
  </div>
</div>

<div id="overlay">
  <div class="ov-box">
    <h2 id="overTitle">GAME OVER</h2>
    <p id="overMsg">Score: 0</p>
    <button class="btn" id="restartBtn">Play Again</button>
  </div>
</div>

<script>
  /* ---- Calendar background ---- */
  (function() {
    const cv=document.getElementById('bg-canvas');
    const cx=cv.getContext('2d');
    const C=14,G=3,S=C+G;
    const GR=['rgba(22,27,34,0)','rgba(14,68,41,.7)','rgba(0,109,50,.8)','rgba(38,166,65,.9)','rgba(57,211,83,1)'];
    let cols,rows,cells=[],streaks=[],W,H,frame=0;
    function resize(){W=cv.width=window.innerWidth;H=cv.height=window.innerHeight;cols=Math.ceil(W/S)+2;rows=Math.ceil(H/S)+2;buildCells();buildStreaks();}
    function buildCells(){cells=[];for(let c=0;c<cols;c++)for(let r=0;r<rows;r++)cells.push({x:c*S,y:r*S,level:Math.random()<.35?0:Math.floor(Math.random()*4)+1,op:Math.random()*.4+.1,ph:Math.random()*Math.PI*2,sp:.003+Math.random()*.004,col:c,row:r});}
    function buildStreaks(){streaks=[];for(let c=0;c<cols;c++)streaks.push({col:c,row:Math.random()*rows,speed:.04+Math.random()*.12,len:4+Math.floor(Math.random()*8),active:Math.random()<.6});}
    function draw(){
      cx.clearRect(0,0,W,H);frame++;
      if(frame%120===0)streaks.forEach(s=>{if(!s.active&&Math.random()<.3){s.active=true;s.row=-s.len;s.speed=.04+Math.random()*.12;}});
      streaks.forEach(s=>{if(s.active){s.row+=s.speed;if(s.row>rows+s.len)s.active=false;}});
      const sm={};streaks.forEach(s=>{if(s.active)sm[s.col]=s.row;});
      cells.forEach(cell=>{
        let lv=cell.level,al=cell.op;
        const sk=sm[cell.col];
        if(sk!==undefined){const d=sk-cell.row;const tail=cell.col%3===0?12:8;if(d>=0&&d<tail){const t=1-d/tail;if(d<1.5){lv=4;al=1;}else{lv=Math.max(lv,Math.round(t*4));al=Math.max(al,t*.9);}}}
        if(lv>0){cell.ph+=cell.sp;al=Math.min(1,al+Math.sin(cell.ph)*.15);}
        cx.globalAlpha=al;cx.fillStyle=GR[lv];cx.beginPath();cx.roundRect(cell.x,cell.y,C,C,2);cx.fill();
      });
      cx.globalAlpha=1;requestAnimationFrame(draw);
    }
    resize();draw();window.addEventListener('resize',resize);
  })();

  /* ---- Snake Game ---- */
  const canvas    = document.getElementById('canvas');
  const ctx       = canvas.getContext('2d');
  const startBtn  = document.getElementById('startBtn');
  const speedRange= document.getElementById('speedRange');
  const speedLabel= document.getElementById('speedLabel');
  const sizeRange = document.getElementById('sizeRange');
  const sizeLabel = document.getElementById('sizeLabel');
  const statsEl   = document.getElementById('stats');
  const overlay   = document.getElementById('overlay');
  const overTitle = document.getElementById('overTitle');
  const overMsg   = document.getElementById('overMsg');
  const restartBtn= document.getElementById('restartBtn');

  let gridSize=20, cellSize;
  let snake,dir,nextDir,food,score,best=0,running=false,gameOver=false;
  let timer;

  function resize(){
    const maxW=Math.min(window.innerWidth-40,560);
    cellSize=Math.floor(maxW/gridSize);
    canvas.width=gridSize*cellSize; canvas.height=gridSize*cellSize;
  }

  function init(){
    overlay.classList.remove('show');
    gameOver=false; running=false; clearInterval(timer);
    resize();
    snake=[{x:Math.floor(gridSize/2),y:Math.floor(gridSize/2)}];
    dir={x:1,y:0}; nextDir={x:1,y:0};
    score=0; placeFood(); render(); updateStats();
    startBtn.textContent='▶ Start';
  }

  function placeFood(){
    const free=[];
    for(let y=0;y<gridSize;y++) for(let x=0;x<gridSize;x++)
      if(!snake.some(s=>s.x===x&&s.y===y)) free.push({x,y});
    if(!free.length){win();return;}
    food=free[Math.floor(Math.random()*free.length)];
  }

  function start(){
    if(gameOver){init();return;}
    if(running){running=false;clearInterval(timer);startBtn.textContent='▶ Start';return;}
    running=true; startBtn.textContent='⏸ Pause';
    timer=setInterval(tick,1000/+speedRange.value);
  }

  function tick(){
    dir={...nextDir};
    const head={x:snake[0].x+dir.x,y:snake[0].y+dir.y};
    if(head.x<0||head.x>=gridSize||head.y<0||head.y>=gridSize){die();return;}
    if(snake.some(s=>s.x===head.x&&s.y===head.y)){die();return;}
    snake.unshift(head);
    if(head.x===food.x&&head.y===food.y){score+=10;placeFood();}
    else snake.pop();
    render(); updateStats();
  }

  function die(){
    running=false; gameOver=true; clearInterval(timer);
    if(score>best) best=score;
    overTitle.textContent='GAME OVER'; overMsg.textContent=`Score: ${score}`;
    overlay.classList.add('show'); updateStats();
  }

  function win(){
    running=false; gameOver=true; clearInterval(timer);
    score+=100; if(score>best)best=score;
    overTitle.textContent='YOU WIN!'; overMsg.textContent=`Score: ${score}`;
    overlay.classList.add('show'); updateStats();
  }

  function render(){
    ctx.fillStyle='#000'; ctx.fillRect(0,0,canvas.width,canvas.height);
    // Subtle grid
    ctx.fillStyle='#080808';
    for(let y=0;y<gridSize;y++) for(let x=0;x<gridSize;x++)
      if((x+y)%2) ctx.fillRect(x*cellSize,y*cellSize,cellSize,cellSize);
    // Food with glow
    ctx.shadowColor='#39d353'; ctx.shadowBlur=12;
    ctx.fillStyle='#39d353';
    ctx.beginPath();
    ctx.arc(food.x*cellSize+cellSize/2,food.y*cellSize+cellSize/2,cellSize/2.5,0,Math.PI*2);
    ctx.fill(); ctx.shadowBlur=0;
    // Snake – gradient green tail
    snake.forEach((s,i)=>{
      const t=1-i/snake.length;
      const r=Math.floor(14*t), g=Math.floor(68+99*t), b=Math.floor(41*t);
      ctx.fillStyle=`rgb(${r},${g},${b})`;
      ctx.beginPath();
      ctx.roundRect(s.x*cellSize+1,s.y*cellSize+1,cellSize-2,cellSize-2,3);
      ctx.fill();
    });
    // Head eyes
    if(snake.length>0){
      const h=snake[0];
      ctx.fillStyle='#fff';
      const cx2=h.x*cellSize+cellSize/2, cy2=h.y*cellSize+cellSize/2;
      const ex=dir.x*cellSize*.15, ey=dir.y*cellSize*.15;
      ctx.beginPath();
      ctx.arc(cx2-dir.y*3+ex,cy2+dir.x*3+ey,2,0,Math.PI*2);
      ctx.arc(cx2+dir.y*3+ex,cy2-dir.x*3+ey,2,0,Math.PI*2);
      ctx.fill();
    }
  }

  function updateStats(){ statsEl.textContent=`score: ${score} | best: ${best}`; }

  function setDir(x,y){
    if(dir.x===-x&&dir.y===-y) return;
    if(!running&&!gameOver) start();
    nextDir={x,y};
  }

  document.addEventListener('keydown',e=>{
    const map={ArrowUp:[0,-1],w:[0,-1],ArrowDown:[0,1],s:[0,1],ArrowLeft:[-1,0],a:[-1,0],ArrowRight:[1,0],d:[1,0]};
    const d=map[e.key];
    if(d){e.preventDefault();setDir(d[0],d[1]);}
    if(e.key===' '){e.preventDefault();start();}
  });

  startBtn.addEventListener('click',start);
  restartBtn.addEventListener('click',init);

  speedRange.addEventListener('input',()=>{
    speedLabel.textContent=speedRange.value;
    if(running){clearInterval(timer);timer=setInterval(tick,1000/+speedRange.value);}
  });

  sizeRange.addEventListener('input',()=>{ sizeLabel.textContent=sizeRange.value; gridSize=+sizeRange.value; init(); });
  window.addEventListener('resize',()=>{resize();render();});
  init();
</script>
</body>
</html>
